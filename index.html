<!DOCTYPE html>
<html>
<head>
    <title>GT4 European Misano ðŸ‡®ðŸ‡¹</title>
    <style>
        body {
            background-color: #1A202C;
            color: #A0AEC0;
            font-family: Arial, sans-serif;
            font-size: 125%; /* Increase the font size */
            text-align: center; /* Center align the whole website */
        }
        .aston-martin-theme {
            color: #006F62;
        }
        table, th, td {
            border: 1px solid #A0AEC0;
            padding: 20px; /* Increase the padding */
            margin: 0 auto; /* Center align the table */
        }
        .highlight {
            background-color: #006F62;
            color: #A0AEC0;
        }
        #countdownTimer {
            font-size: 2em; /* Make the countdown timer larger */
            font-weight: bold; /* Make the countdown timer bold */
        }
        #countdownTimer span {
            display: inline-block;
            margin: 0 10px;
        }
        #countdownTimer span::after {
            content: attr(data-label);
            display: block;
            font-size: 0.5em;
            font-weight: normal;
        }
        #eventName {
            font-size: 3em; /* Make the event name larger */
            font-weight: bold; /* Make the event name bold */
        }
    </style>
</head>
<body>
    <header>
        <h1 class="aston-martin-theme">GT4 European Misano ðŸ‡®ðŸ‡¹</h1>
    </header>
    <main>
       <section id="countdown">
            <h2 class="aston-martin-theme">Next session is:</h2>
            <p id="eventName"></p> <!-- Add a new paragraph for the event name -->
            <p id="countdownTimer"></p>
        </section>
<body>
          <section id="timetable">
            <h2 class="aston-martin-theme">Timetable Local ðŸ‡®ðŸ‡¹ (GMT+1)</h2>
            <table class="highlight">
                <tr>
                    <th>Event</th>
                    <th>Date</th>
                    <th>Start</th>
                    <th>End</th>
                </tr>
                <tr>
                    <td>Qualy</td>
                    <td>18/05</td>
                    <td>09:35</td>
                    <td>10:35</td>
                </tr>
                <tr>
                    <td>Race 1</td>
                    <td>18/05</td>
                    <td>16:35</td>
                    <td>17:35</td>
                </tr>
                <tr>
                    <td>Race 2</td>
                    <td>19/05</td>
                    <td>12:15</td>
                    <td>13:15</td>
                </tr>
            </table>
        </section>
        <section id="timetable-brazil">
            <h2 class="aston-martin-theme">Timetable Brazil ðŸ‡§ðŸ‡· (GMT-3)</h2>
            <table class="highlight">
                <tr>
                    <th>Event</th>
                    <td>Date</td>
                    <th>Start</th>
                    <th>End</th>
                </tr>
                <tr>
                    <td>Qualy</td>
                    <td>18/05</td>
                    <td>04:35</td>
                    <td>05:35</td>
                </tr>
                <tr>
                    <td>Race 1</td>
                    <td>18/05</td>
                    <td>11:35</td>
                    <td>12:35</td>
                </tr>
                <tr>
                    <td>Race 2</td>
                    <td>19/05</td>
                    <td>07:15</td>
                    <td>08:15</td>
                </tr>
            </table>
        </section>
    
    </main>
    <footer>
        <p>Â© 2024 Roberto Faria</p>
    </footer>
   <script>
        async function loadEvents() {
            const response = await fetch('events.csv');
            const csv = await response.text();
            const lines = csv.split('\n').slice(1); // Skip the header
            return lines.map(line => {
                const [name, start, end] = line.split(',');
                return {name, start: new Date(start), end: new Date(end)};
            });
        }

        function formatTime(date) {
            return date.toISOString().split('T')[1].slice(0, 5);
        }

        function formatDate(date) {
            return date.toISOString().split('T')[0].slice(5).split('-').reverse().join('/');
        }

        async function populateTables() {
            const events = await loadEvents();
            const table1 = document.querySelector('#timetable table');
            const table2 = document.querySelector('#timetable-brazil table');

            for (const event of events) {
                const row1 = document.createElement('tr');
                row1.innerHTML = `<td>${event.name}</td><td>${formatDate(event.start)}</td><td>${formatTime(event.start)}</td><td>${formatTime(event.end)}</td>`;
                table1.appendChild(row1);

                const row2 = document.createElement('tr');
                const startBrazil = new Date(event.start.getTime() - 5 * 60 * 60 * 1000);
                const endBrazil = new Date(event.end.getTime() - 5 * 60 * 60 * 1000);
                row2.innerHTML = `<td>${event.name}</td><td>${formatDate(startBrazil)}</td><td>${formatTime(startBrazil)}</td><td>${formatTime(endBrazil)}</td>`;
                table2.appendChild(row2);
            }
        }

        populateTables();
        startCountdown();
    </script>
</body>
</html>
